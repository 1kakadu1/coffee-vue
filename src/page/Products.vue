<script  lang="ts" setup>
import PageLayoutComponent from "@/components/layouts/PageLayout.vue";
import ProductSkeleton from '@/components/cards/CardProductSkeleton.vue';
import CardProduct from '@/components/cards/CardProduct.vue';
import bg from "@/assets/img/products/producs-cofee.png";
import { api } from "@/services/api";
import useSWRV from "swrv/dist/use-swrv";
import { computed, ref } from "vue";
import { useRoute, useRouter } from "vue-router";
import { RouterPath } from "@/types";
const { query } = useRoute()
const router = useRouter();
const activeCategory = ref(query['category'] ? query['category'] : 'id-all');
const { data: categotyList } = useSWRV("category/list", api.getCategoryList);
const { data } = useSWRV(()=>{return activeCategory.value }, api.getProductsByCategoryID);
const isLoadingProduct = computed(() => {
    return data.value === undefined
})
const isLoadingCategory = computed(() => {
    return categotyList.value === undefined
})

const setCategory = (id: string)=>{
    activeCategory.value = id;
    router.push({ path: RouterPath.products, query: { category: id } })
}

const icons = computed(()=>{
    return{
        "id-tea": `<svg width="67" height="66" viewBox="0 0 67 66" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_517_6909)">
                        <path d="M65.6914 26.6191H54.9609V23.8906C54.9609 23.1786 54.375 22.6015 53.6523 22.6015H25.3867C24.6641 22.6015 24.0781 23.1786 24.0781 23.8906C24.0781 24.6025 24.6641 25.1796 25.3867 25.1796H52.3438V35.0624C52.3438 43.7439 47.6384 51.8127 40.0406 56.203H14.9203C7.3225 51.8128 2.61719 43.7439 2.61719 35.0625V25.1798H11.3848C12.1074 25.1798 12.6934 24.6027 12.6934 23.8907C12.6934 23.1788 12.1074 22.6016 11.3848 22.6016H1.30859C0.585988 22.6016 0 23.1788 0 23.8907V35.0625C0 39.9351 1.32953 44.7129 3.84491 48.8791C5.54124 51.6888 7.74229 54.17 10.3198 56.2031H1.30859C0.585988 56.2031 0 56.7802 0 57.4922C0 62.1835 3.87435 66 8.63672 66H49.4648C54.2272 66 58.1016 62.1835 58.1016 57.4922C58.1016 56.7802 57.5156 56.2031 56.793 56.2031H44.6411C47.0135 54.3319 49.0657 52.0803 50.7002 49.5429H54.3939C61.3449 49.5429 67 43.9722 67 37.125V27.9082C67 27.1962 66.4141 26.6191 65.6914 26.6191ZM55.3411 58.7812C54.742 61.4331 52.3347 63.4219 49.4648 63.4219H8.63672C5.76684 63.4219 3.35968 61.4331 2.76048 58.7812H14.5698H40.3912H55.3411ZM54.9609 35.0625V34.3535H59.1484V37.125C59.1484 39.7075 57.0156 41.8085 54.3939 41.8085H54.0967C54.6679 39.6164 54.9609 37.3499 54.9609 35.0625ZM64.3828 37.125C64.3828 42.5507 59.9018 46.9648 54.3939 46.9648H52.1667C52.5845 46.1242 52.9577 45.2636 53.2838 44.3867H54.3939C58.4588 44.3867 61.7656 41.1291 61.7656 37.125V33.0644C61.7656 32.3525 61.1796 31.7754 60.457 31.7754H54.9609V29.1973H64.3828V37.125Z" fill="currentColor"/>
                        <path d="M28.7301 7.13406L28.0493 6.29191C27.0498 5.05596 27.0483 3.32823 28.0457 2.09047C28.4951 1.53282 28.4004 0.722002 27.8343 0.279466C27.268 -0.163327 26.4451 -0.0698695 25.9957 0.487779C24.2367 2.67094 24.2393 5.71815 26.0021 7.89821L26.683 8.74036C27.9891 10.3556 27.991 12.6133 26.6877 14.231L25.9899 15.097C25.5406 15.6546 25.6353 16.4655 26.2014 16.908C26.4421 17.0961 26.729 17.1875 27.014 17.1875C27.3996 17.1875 27.7815 17.0204 28.04 16.6997L28.7377 15.8337C30.8027 13.2708 30.7997 9.69336 28.7301 7.13406Z" fill="currentColor"/>
                        <path d="M35.9836 10.0324L35.3027 9.19037C34.3032 7.95429 34.3018 6.22656 35.2992 4.9888C35.7485 4.43116 35.6538 3.62034 35.0877 3.1778C34.5215 2.73501 33.6985 2.82846 33.2491 3.38611C31.4901 5.56927 31.4927 8.61648 33.2555 10.7967L33.9364 11.6388C35.2424 13.2541 35.2443 15.5121 33.941 17.1296L33.2434 17.9954C32.794 18.5531 32.8887 19.3639 33.4548 19.8064C33.6955 19.9945 33.9825 20.0858 34.2675 20.0858C34.653 20.0858 35.0351 19.9186 35.2934 19.598L35.9909 18.7321C38.056 16.1694 38.053 12.592 35.9836 10.0324Z" fill="currentColor"/>
                        <path d="M21.4767 10.0325L20.7959 9.1905C19.7964 7.95455 19.7949 6.22669 20.7922 4.98893C21.2416 4.43128 21.1468 3.62046 20.5807 3.1778C20.0145 2.73513 19.1915 2.82872 18.7422 3.38611C16.9833 5.56926 16.9859 8.61661 18.7487 10.7967L19.4296 11.6388C20.7355 13.2541 20.7375 15.5121 19.4343 17.1294L18.7365 17.9953C18.2872 18.553 18.3818 19.3638 18.9479 19.8064C19.1885 19.9945 19.4754 20.0859 19.7605 20.0859C20.146 20.0859 20.528 19.9188 20.7863 19.5983L21.4842 18.7323C23.5492 16.1695 23.5461 12.5921 21.4767 10.0325Z" fill="currentColor"/>
                        <path d="M19.6654 22.9788C19.422 22.7391 19.0844 22.6011 18.7402 22.6011C18.3961 22.6011 18.0585 22.7391 17.8151 22.9788C17.5718 23.2199 17.4316 23.5512 17.4316 23.8902C17.4316 24.2292 17.5717 24.5618 17.8151 24.8028C18.0585 25.0426 18.3961 25.1793 18.7402 25.1793C19.0844 25.1793 19.422 25.0426 19.6654 24.8028C19.91 24.5618 20.0488 24.2305 20.0488 23.8902C20.0488 23.5512 19.91 23.2186 19.6654 22.9788Z" fill="currentColor"/>
                        <path d="M47.3711 33.7734C46.6485 33.7734 46.0625 34.3506 46.0625 35.0625C46.0625 39.8474 44.0923 44.5497 40.657 47.9638C40.1482 48.4694 40.152 49.2856 40.6652 49.7868C40.9204 50.036 41.2534 50.1604 41.5865 50.1604C41.9233 50.1603 42.2601 50.0329 42.516 49.7786C46.4331 45.8856 48.6797 40.5218 48.6797 35.0625C48.6797 34.3506 48.0937 33.7734 47.3711 33.7734Z" fill="currentColor"/>
                        <path d="M38.4575 51.4626C38.1023 50.8424 37.3042 50.6234 36.6748 50.9731L36.6449 50.9898C36.0154 51.3396 35.793 52.1258 36.148 52.7458C36.3886 53.1658 36.832 53.4018 37.289 53.4018C37.5068 53.4018 37.7276 53.3481 37.9307 53.2353L37.9606 53.2187C38.5901 52.8688 38.8125 52.0826 38.4575 51.4626Z" fill="currentColor"/>
                        </g>
                        <defs>
                        <clipPath id="clip0_517_6909">
                        <rect width="67" height="66" fill="white"/>
                        </clipPath>
                        </defs>
                    </svg>
                `,
        "id-all":`<svg width="54" height="72" viewBox="0 0 54 72" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M16.4998 20.9999C15.9478 20.9999 15.4198 20.6969 15.1558 20.1719L6.15582 2.17188C5.78682 1.43088 6.08682 0.527877 6.82782 0.158877C7.57182 -0.213123 8.46882 0.0868773 8.84082 0.830877L17.8408 18.8309C18.2128 19.5719 17.9098 20.4719 17.1688 20.8439C16.9558 20.9489 16.7278 20.9999 16.4998 20.9999Z" fill="currentColor"/>
                <path d="M37.4999 20.9999C37.2749 20.9999 37.0469 20.9489 36.8309 20.8409C36.0899 20.4689 35.7899 19.5689 36.1589 18.8279L45.1589 0.827899C45.5309 0.0838996 46.4309 -0.2131 47.1719 0.1559C47.9129 0.5249 48.2129 1.4279 47.8439 2.1689L38.8439 20.1689C38.5769 20.6969 38.0489 20.9999 37.4999 20.9999Z" fill="currentColor"/>
                <path d="M49.5001 2.99997H4.50008C3.67208 2.99997 3.00008 2.32797 3.00008 1.49997C3.00008 0.671968 3.67208 -3.15707e-05 4.50008 -3.15707e-05H49.5001C50.3281 -3.15707e-05 51.0001 0.671968 51.0001 1.49997C51.0001 2.32797 50.3281 2.99997 49.5001 2.99997Z" fill="currentColor"/>
                <path d="M43.4999 30H10.4999C8.01893 30 5.99993 27.981 5.99993 25.5V22.5C5.99993 20.019 8.01893 18 10.4999 18H43.4999C45.9809 18 47.9999 20.019 47.9999 22.5V25.5C47.9999 27.981 45.9809 30 43.4999 30ZM10.4999 21C9.67193 21 8.99993 21.672 8.99993 22.5V25.5C8.99993 26.328 9.67193 27 10.4999 27H43.4999C44.3279 27 44.9999 26.328 44.9999 25.5V22.5C44.9999 21.672 44.3279 21 43.4999 21H10.4999Z" fill="currentColor"/>
                <path d="M43.5 72H10.5C4.71 72 0 67.29 0 61.5C0 60.072 0.282 58.686 0.837 57.384L12.099 27.963C12.396 27.189 13.269 26.808 14.037 27.099C14.811 27.396 15.198 28.263 14.901 29.037L3.618 58.512C3.201 59.49 3 60.48 3 61.5C3 65.634 6.366 69 10.5 69H43.5C47.634 69 51 65.634 51 61.5C51 60.48 50.799 59.49 50.403 58.563L39.099 29.037C38.802 28.263 39.189 27.396 39.963 27.099C40.734 26.805 41.601 27.186 41.901 27.963L53.184 57.438C53.718 58.689 54 60.072 54 61.5C54 67.29 49.29 72 43.5 72Z" fill="currentColor"/>
                <path d="M36.366 49.5C33.417 49.5 31.875 48.021 30.636 46.833C29.529 45.768 28.728 45 26.985 45C25.245 45 24.447 45.768 23.34 46.833C22.101 48.021 20.562 49.5 17.616 49.5C14.67 49.5 13.131 48.021 11.895 46.83C10.788 45.768 9.987 45 8.25 45C7.422 45 6.75 44.328 6.75 43.5C6.75 42.672 7.422 42 8.25 42C11.196 42 12.735 43.479 13.971 44.67C15.078 45.732 15.879 46.5 17.616 46.5C19.353 46.5 20.154 45.732 21.261 44.67C22.497 43.482 24.039 42 26.985 42C29.934 42 31.476 43.479 32.715 44.667C33.825 45.729 34.626 46.5 36.366 46.5C38.109 46.5 38.91 45.732 40.02 44.667C41.259 43.479 42.801 42 45.75 42C46.578 42 47.25 42.672 47.25 43.5C47.25 44.328 46.578 45 45.75 45C44.007 45 43.206 45.768 42.096 46.833C40.857 48.021 39.315 49.5 36.366 49.5Z" fill="currentColor"/>
            </svg>
        `,
        "id-coffee":`<svg width="82" height="77" viewBox="0 0 82 77" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M80.5575 1.45711C78.6346 -0.485704 75.5063 -0.485704 73.5835 1.45711L63.6076 11.5379C63.1381 12.0124 63.1374 12.782 63.6062 13.2571C64.075 13.7323 64.8356 13.7329 65.3048 13.2586L75.2808 3.17785C76.2677 2.18058 77.8734 2.18091 78.8601 3.17785C79.3356 3.65848 79.5975 4.30123 79.5975 4.98774C79.5975 5.67425 79.3355 6.31699 78.8601 6.79747L45.2247 40.7868C44.2378 41.7839 42.6323 41.7839 41.6454 40.7868C41.1699 40.3063 40.9079 39.6636 40.9079 38.9771C40.9079 38.5467 41.011 38.1336 41.205 37.7668C41.208 37.7614 41.2115 37.7564 41.2144 37.7509C41.3286 37.5389 41.4724 37.3421 41.6454 37.1672L60.2757 18.3409C60.7453 17.8664 60.746 17.0967 60.2772 16.6216C59.8086 16.1465 59.048 16.1457 58.5786 16.6202L40.3119 35.0786C40.7314 31.5618 42.0786 28.411 42.9378 26.6901C43.2575 26.0522 43.2244 25.2738 42.8512 24.6587C42.5202 24.1131 41.9743 23.7873 41.3914 23.7873H38.5705C37.907 23.7873 37.3694 24.3316 37.3694 25.003C37.3694 25.6745 37.907 26.2188 38.5705 26.2188H40.4905C39.4652 28.3952 38.0709 32.0061 37.8196 35.9567H6.2838C6.03187 32.0001 4.63787 28.3913 3.61335 26.2188H15.5532C15.7489 27.1318 16.0921 28.563 16.5985 30.0931C17.5527 32.9803 21.2863 34.7726 21.7088 34.9674C22.0249 35.1131 22.3887 35.1131 22.7048 34.9674C23.1271 34.7726 26.8585 32.9807 27.8168 30.0929C28.3221 28.563 28.6642 27.1318 28.8595 26.2188H30.7363C31.3999 26.2188 31.9375 25.6745 31.9375 25.003C31.9375 24.3316 31.3999 23.7873 30.7363 23.7873H27.8742C27.2899 23.7873 26.7901 24.2133 26.6905 24.7962C26.6869 24.8178 26.3134 26.9755 25.5391 29.3204C25.0878 30.6802 23.2846 31.9072 22.2072 32.4997C21.1503 31.9155 19.3239 30.6752 18.8764 29.3213C18.0997 26.9747 17.7249 24.8168 17.7211 24.7957C17.6214 24.2129 17.1219 23.7874 16.5375 23.7874H2.85197C2.19677 23.7874 1.5965 24.1309 1.24656 24.7061C0.883965 25.3016 0.852414 26.0606 1.16504 26.6892C1.91729 28.1937 3.57603 31.9137 3.87457 35.9569H2.52685C1.38045 35.9569 0.447698 36.9007 0.447698 38.0607V40.618C0.447698 41.778 1.38045 42.7218 2.52685 42.7218H3.36655C3.16043 44.2402 2.89072 46.1129 2.5954 48.0724C2.4953 48.7362 2.94582 49.3562 3.60166 49.4576C3.663 49.4671 3.72402 49.4717 3.7844 49.4717C4.36769 49.4717 4.87955 49.0406 4.9702 48.4391C5.28891 46.3246 5.57831 44.3082 5.79116 42.7218H38.3112C38.9049 47.1404 39.9953 54.1354 41.5587 63.5506C42.0442 66.4686 41.2772 69.3934 39.4543 71.5752C37.8417 73.5054 35.6448 74.5683 33.2684 74.5683H10.8351C8.45872 74.5683 6.26186 73.5054 4.64908 71.5752C2.82618 69.3934 2.05919 66.4686 2.54511 63.5502C2.99595 60.8345 3.41396 58.2804 3.78728 55.9589C3.89394 55.2962 3.44951 54.6715 2.79479 54.5637C2.13927 54.4547 1.52283 54.9055 1.41632 55.5682C1.04364 57.8857 0.626273 60.4356 0.176233 63.1469C-0.427076 66.7719 0.534663 70.4161 2.81497 73.1453C4.86177 75.595 7.78511 77 10.8354 77H33.2687C36.3191 77 39.2422 75.595 41.2889 73.1455C43.5692 70.4163 44.5311 66.7719 43.9281 63.1472C42.4604 54.3074 41.4114 47.6135 40.8012 43.196C41.6026 43.7079 42.5186 43.9651 43.4353 43.9651C44.6981 43.9651 45.9608 43.4793 46.9222 42.508L80.5575 8.5182C81.4877 7.57816 82 6.32445 82 4.98774C82 3.65103 81.4878 2.39715 80.5575 1.45711ZM2.85004 40.2898V38.388H38.5404C38.5182 38.582 38.5055 38.7785 38.5055 38.9769C38.5055 39.4271 38.5649 39.8673 38.6775 40.2898H2.85004Z" fill="currentColor"/>
                        <path d="M10.8353 67.7897C10.4552 67.7897 10.097 67.5916 9.77024 67.201C9.22171 66.5449 8.99749 65.6247 9.1554 64.6759C10.3928 57.2236 11.3446 51.2153 11.9846 46.8177C12.0813 46.1534 11.6276 45.5356 10.9713 45.4377C10.3165 45.3398 9.70458 45.7989 9.60801 46.4633C8.97042 50.8447 8.02102 56.8367 6.78637 64.2724C6.51074 65.9283 6.93003 67.5683 7.93661 68.7719C8.71834 69.7066 9.74782 70.2213 10.8353 70.2213C11.4988 70.2213 12.0365 69.6769 12.0365 69.0055C12.0365 68.3341 11.4988 67.7897 10.8353 67.7897Z" fill="currentColor"/>
                        <path d="M43.5224 40.1564C44.1858 40.1564 44.7236 39.612 44.7236 38.9406C44.7236 38.2691 44.1858 37.7248 43.5224 37.7248C42.859 37.7248 42.3212 38.2691 42.3212 38.9406C42.3212 39.612 42.859 40.1564 43.5224 40.1564Z" fill="currentColor"/>
                    </svg> `
    }
})

</script>
<template>
    <PageLayoutComponent>
        <div class="products__header">
            <div class="products__bg">
                <div class="container">
                    <div class="row">
                        <div class="col-left">
                            <h1 class="products__title">Свежеобжаренный кофе</h1>
                        </div>
                        <div class="col-right">
                            <img :src="bg" class="products__img" loading="lazy" decoding="async" alt="">
                        </div>
                    </div>
                    
                    
                </div>
            </div>
            <svg viewBox="0 0 2177 288" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <path  d="M0 180L90.7083 150C181.417 120 362.833 60 544.25 36C725.667 12 907.083 24 1088.5 54C1269.92 84 1451.33 132 1632.75 174C1814.17 216 1995.58 252 2086.29 270L2177 288L2177 0L2086.29 0C1995.58 0 1814.17 0 1632.75 0C1451.33 0 1269.92 0 1088.5 0C907.083 0 725.667 0 544.25 0C362.833 0 181.417 0 90.7083 0L0 0L0 180Z" fill="#F9B300" fill-opacity="1.000000" fill-rule="evenodd"/>
            </svg>
        </div>
        <div class="negative__margin">
            <div class="container">
                <ul class="category">
                    <li class="category__item" :class="{active: activeCategory === item.id}" v-if="!isLoadingCategory" v-for="item in categotyList" :key="item.id" @click="()=> setCategory(item.id)">
                        <h4 class="category__name">
                            {{ item.name }}
                        </h4>
                       <div class="category__preview" v-html="icons[item.id] ||  icons['id-all']"></div>
                    </li>
                    <li class="category__item-loading skeleton" v-else v-for="item in [1,2,3]" :key="item">
                    </li>
                </ul>
                <ul class="products__list" >
                    <li v-for="item in [1,2,3,4,5,6]" :key="item" v-if="isLoadingProduct">
                        <ProductSkeleton size="full" />
                    </li>
                    <li v-for="item in data || []" :key="item.id" v-else >
                        <card-product :product="item" size="full"></card-product>
                    </li>
                </ul>
            </div>
        </div>


    </PageLayoutComponent>
</template>


<style lang="scss" scoped>
    .products__header{
        overflow: hidden;
    }
    .products__bg{
        background-color: rgb(249, 179, 0);
        padding: 0px 40px;
        min-height: 468px;
        
    }
    .products__title{
        color: #fff;
        font-size: 60px;
        font-weight: 900;
    }
    .products__img{
        max-width: 682px;
        height: 100%;
        position: absolute;
        right: 0;
        top: 0;
        width: 100%;
        object-fit: contain;
        object-position: center;
    }
    .row{
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .col-left{
        width: 70%;
    }
    .col-right{
        position: relative;
        width: 30%;
        height: 455px;
    }

    .products__decor{
        width: 100%;
        margin-left: -10px;
        margin-right: -10px;
    }

    .products__list{
        margin-bottom: 100px;
        display: flex;
        flex-wrap: wrap;
        margin-left: -20px;
        margin-right: -20px;
        li{
            width: 33.333%;
            padding: 10px;
        }
    }

.category{
    display: flex;
    align-items: center;
    gap: 20px;
    &__item,&__item-loading{
        cursor: pointer;
        width: 190px;
        height: 190px;
        padding: 10px;
        border-radius: 20px;
        background-color: #fff;
        box-shadow: 0 0 30px 0 rgba(149, 149, 149, 0.25);
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background-color 300ms ease, color 300ms ease;
        flex-direction: column;
        &.active{
            background-color: #A25F4B;
            
            & .category__name{
                color: #fff;
                transition: color 300ms ease;
            }
            & .category__preview{
                color: #fff;
                transition: color 300ms ease;
            }
        }
    }
    &__name{
        font-weight: 500;
        font-size: 20px;
        color: #000;
        padding-bottom: 18px;
        transition: color 300ms ease;
    }
    &__preview{
        color: #000;
        transition: color 300ms ease;
        // svg path{
        //     fill: #000;
        //     transition: fill 300ms ease;
        // }
    }
}

.negative__margin{
    margin-top: -300px;
}
</style>
  
  